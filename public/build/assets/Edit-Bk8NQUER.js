import{d as se,m as ne,z as w,q as le,c as i,H as ie,Q as de,h as ce,o as d,w as F,f as l,e as r,u as s,j as ue,l as ge,t as g,s as pe,g as c,a as p,b as V,v,x as k,F as S,r as A,k as m}from"./app-DiUTJyO5.js";import{F as fe}from"./FinancialAppLayout-CFa_U7sL.js";import{u as be}from"./useTranslation-VILxPNR3.js";import{f as me}from"./formatCurrency-6zMsDc4Z.js";import{A as ye}from"./arrow-left-B1dTIe6p.js";import{C as he}from"./credit-card-Camh_JO7.js";import{C as j}from"./chevron-down-L7Q_gKco.js";import{S as E}from"./search-F4d95sN1.js";import{D as xe}from"./dollar-sign-eEgsWLBc.js";import{C as we}from"./calendar-DmKfoy3u.js";import{C as ve}from"./clock-BWAvsyss.js";import{F as ke}from"./file-text-CCjFVjCG.js";import{T as _e}from"./tag-CD8BehX9.js";import{S as Ce}from"./save-CWPPYPeJ.js";import"./useDarkMode-CxWBGi-X.js";import"./createLucideIcon-Q3JMls56.js";import"./x-BZ8hJlM6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./trending-up-7awjo4lm.js";import"./settings-m4fMQXqo.js";import"./sun-BkabMr88.js";const Se={class:"bg-gradient-to-r from-teal-500 to-teal-600 dark:from-teal-600 dark:to-teal-700 rounded-b-[24px] px-4 pt-4 pb-6 mb-4 shadow-lg dark:shadow-2xl"},Ae={class:"flex items-center justify-between mb-4"},Te={class:"text-xl font-semibold text-white truncate flex-1 text-center"},De={class:"px-4"},$e={class:"mb-6"},Fe={class:"flex bg-gray-100 dark:bg-gray-700 rounded-xl p-1"},Ve={class:"mb-4 relative dropdown-container"},je={class:"flex items-center gap-2"},Ee={class:"text-gray-900 dark:text-white"},Ue={key:0,class:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg z-50"},Le={class:"p-3 border-b border-gray-200 dark:border-gray-700"},Me={class:"relative"},ze={class:"max-h-64 overflow-y-auto overscroll-contain"},Be=["onClick"],Oe={class:"text-gray-900 dark:text-white truncate"},Pe={class:"text-sm text-gray-500 ml-2 flex-shrink-0"},qe={class:"mb-4 relative dropdown-container"},Ne={class:"flex items-center gap-2"},He={class:"text-gray-900 dark:text-white"},Je={key:0,class:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg z-50"},Ke={class:"p-3 border-b border-gray-200 dark:border-gray-700"},We={class:"relative"},Ie={class:"max-h-64 overflow-y-auto overscroll-contain"},Qe=["onClick"],Ye={class:"text-gray-900 dark:text-white truncate"},Ge={class:"mb-4 relative"},Re=["value"],Xe={class:"absolute left-4 text-gray-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-2 peer-focus:left-3 peer-focus:text-xs peer-focus:text-teal-500 peer-focus:bg-white dark:peer-focus:bg-gray-800 peer-focus:px-1 -top-2 text-xs bg-white dark:bg-gray-800 px-1"},Ze={class:"grid grid-cols-2 gap-3 mb-4"},et={class:"relative"},tt={class:"absolute left-4 text-gray-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-2 peer-focus:left-3 peer-focus:text-xs peer-focus:text-teal-500 peer-focus:bg-white dark:peer-focus:bg-gray-800 peer-focus:px-1 -top-2 text-xs bg-white dark:bg-gray-800 px-1"},rt={class:"relative"},at={class:"absolute left-4 text-gray-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-2 peer-focus:left-3 peer-focus:text-xs peer-focus:text-teal-500 peer-focus:bg-white dark:peer-focus:bg-gray-800 peer-focus:px-1 -top-2 text-xs bg-white dark:bg-gray-800 px-1"},ot={class:"mb-4 relative"},st={class:"absolute left-4 text-gray-500 transition-all duration-200 peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-2 peer-focus:left-3 peer-focus:text-xs peer-focus:text-teal-500 peer-focus:bg-white dark:peer-focus:bg-gray-800 peer-focus:px-1 -top-2 text-xs bg-white dark:bg-gray-800 px-1"},nt={class:"mb-6"},lt={class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 block"},it={class:"flex flex-wrap gap-2"},dt=["onClick"],ct=["disabled"],Ut=se({__name:"Edit",props:{transaction:{},masterData:{},pageTitle:{}},setup(U){const n=U;be();const{success:L,error:T,warning:ut,info:gt}=ne(),y=w(!1),h=w(!1),f=w(""),b=w(""),D=t=>{if(!t)return"";const e=t.replace(/[^\d]/g,"");return e?e.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""},_=w(""),x=new Date(n.transaction.date),M=x.getUTCFullYear(),z=String(x.getUTCMonth()+1).padStart(2,"0"),B=String(x.getUTCDate()).padStart(2,"0"),O=String(x.getUTCHours()).padStart(2,"0"),P=String(x.getUTCMinutes()).padStart(2,"0"),q=`${M}-${z}-${B}`,N=`${O}:${P}`,a=le({type:n.transaction.type,account_id:n.transaction.account_id?.toString()||"",transaction_category_id:n.transaction.transaction_category_id?.toString()||"",amount:n.transaction.amount.toString(),date:q,time:N,note:n.transaction.note||"",flag:n.transaction.flag||"normal",tag_ids:n.transaction.tags?.map(t=>t.id)||[]});_.value=D(n.transaction.amount.toString());const C=t=>{if(!t)return 0;const e=t.replace(/\./g,"");return parseFloat(e)||0},H=t=>{const e=t.target,o=e.value,u=D(o);_.value=u,e.value=u,a.amount=C(u).toString()},J=i(()=>{const t=a.type==="income"?n.masterData.income_categories:n.masterData.expense_categories;return Array.isArray(t)?t:[]}),K=i(()=>f.value?n.masterData.accounts.filter(t=>t.name.toLowerCase().includes(f.value.toLowerCase())):n.masterData.accounts),W=i(()=>{const t=a.type==="income"?n.masterData.income_categories:n.masterData.expense_categories;return Array.isArray(t)?b.value?t.filter(e=>e.name.toLowerCase().includes(b.value.toLowerCase())):t:[]}),I=i(()=>{const t=n.masterData.accounts;return Array.isArray(t)?t.find(e=>e.id.toString()===a.account_id):null}),Q=i(()=>{const t=J.value;return Array.isArray(t)?t.find(e=>e.id.toString()===a.transaction_category_id):null}),Y=i(()=>a.errors&&a.errors.account_id),G=i(()=>a.errors&&a.errors.transaction_category_id),R=i(()=>a.errors&&a.errors.amount),X=i(()=>a.errors&&a.errors.date),Z=t=>{a.account_id=t.toString(),y.value=!1,f.value=""},ee=t=>{a.transaction_category_id=t.toString(),h.value=!1,b.value=""},te=t=>{const e=a.tag_ids.indexOf(t);e===-1?a.tag_ids.push(t):a.tag_ids.splice(e,1)},re=()=>{const t=ae();if(t.length>0){T(`Mohon lengkapi: ${t.join(", ")}`);return}const e=a.data(),o={...e,amount:C(e.amount),date:`${e.date} ${e.time}:00`};a.transform(()=>o).put(`/transactions/${n.transaction.id}`,{onSuccess:()=>{L("Transaksi berhasil diperbarui")},onError:u=>{oe(u)}})},ae=()=>{const t=[];return a.account_id||t.push("Akun"),a.transaction_category_id||t.push("Kategori"),(!a.amount||C(a.amount)<=0)&&t.push("Jumlah yang valid"),a.date||t.push("Tanggal"),a.time||t.push("Waktu"),t},oe=t=>{const e=[];Object.keys(t).forEach(o=>{Array.isArray(t[o])?e.push(...t[o]):e.push(t[o])}),e.length>0&&T(`Terjadi kesalahan: ${e.join(", ")}`)},$=t=>{t.target.closest(".dropdown-container")||(y.value=!1,h.value=!1,f.value="",b.value="")};return ie(()=>{document.addEventListener("click",$)}),de(()=>{document.removeEventListener("click",$)}),(t,e)=>(d(),ce(fe,{showHeader:!1,showFab:!1,containerClass:"px-0 pb-32"},{default:F(()=>[l(s(ue),{title:t.pageTitle},null,8,["title"]),r("div",Se,[r("div",Ae,[l(s(ge),{href:"/transactions",class:"p-2 bg-white/20 hover:bg-white/30 rounded-xl text-white transition-colors duration-200 min-w-[44px] min-h-[44px] flex items-center justify-center"},{default:F(()=>[l(s(ye),{class:"w-5 h-5"})]),_:1}),r("h1",Te,g(t.pageTitle),1),e[10]||(e[10]=r("div",{class:"w-[44px]"},null,-1))])]),r("div",De,[r("form",{onSubmit:e[9]||(e[9]=pe(o=>re(),["prevent"])),class:"bg-white dark:bg-gray-800 rounded-xl shadow-md border-gray-200 dark:border-gray-700 p-6 mb-4"},[r("div",$e,[r("div",Fe,[r("button",{type:"button",onClick:e[0]||(e[0]=o=>s(a).type="income"),class:c([s(a).type==="income"?"bg-teal-500 text-white shadow-md":"text-gray-700 dark:text-gray-300","flex-1 py-2 rounded-lg text-sm font-medium transition-all duration-200"])}," Pemasukan ",2),r("button",{type:"button",onClick:e[1]||(e[1]=o=>s(a).type="expense"),class:c([s(a).type==="expense"?"bg-coral-500 text-white shadow-md":"text-gray-700 dark:text-gray-300","flex-1 py-2 rounded-lg text-sm font-medium transition-all duration-200"])}," Pengeluaran ",2)])]),r("div",Ve,[r("button",{onClick:e[2]||(e[2]=o=>y.value=!y.value),class:c(["w-full px-4 py-3 border rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent flex items-center justify-between transition-colors duration-200",Y.value?"border-red-500 dark:border-red-400":"border-gray-200 dark:border-gray-700"]),type:"button"},[r("div",je,[l(s(he),{class:"w-4 h-4 text-gray-500"}),r("span",Ee,g(I.value?.name||"Pilih Akun"),1)]),l(s(j),{class:"w-4 h-4 text-gray-500"})],2),y.value?(d(),p("div",Ue,[r("div",Le,[r("div",Me,[l(s(E),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),v(r("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>f.value=o),type:"text",placeholder:"Cari akun...",class:"w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-teal-500"},null,512),[[k,f.value]])])]),r("div",ze,[(d(!0),p(S,null,A(K.value,o=>(d(),p("button",{key:o.id,onClick:u=>Z(o.id),class:"w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center justify-between border-none bg-transparent focus:bg-gray-50 dark:focus:bg-gray-700 transition-colors",type:"button"},[r("span",Oe,g(o.name),1),r("span",Pe,g(s(me)(o.current_balance,"decimal")),1)],8,Be))),128))])])):V("",!0)]),r("div",qe,[r("button",{onClick:e[4]||(e[4]=o=>h.value=!h.value),class:c(["w-full px-4 py-3 border rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent flex items-center justify-between transition-colors duration-200",G.value?"border-red-500 dark:border-red-400":"border-gray-200 dark:border-gray-700"]),type:"button"},[r("div",Ne,[r("div",{class:c(["w-3 h-3 rounded-full",s(a).type==="income"?"bg-teal-500":"bg-coral-500"])},null,2),r("span",He,g(Q.value?.name||"Pilih Kategori"),1)]),l(s(j),{class:"w-4 h-4 text-gray-500"})],2),h.value?(d(),p("div",Je,[r("div",Ke,[r("div",We,[l(s(E),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),v(r("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>b.value=o),type:"text",placeholder:"Cari kategori...",class:"w-full pl-10 pr-4 py-2 text-sm border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-teal-500"},null,512),[[k,b.value]])])]),r("div",Ie,[(d(!0),p(S,null,A(W.value,o=>(d(),p("button",{key:o.id,onClick:u=>ee(o.id),class:"w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2 border-none bg-transparent focus:bg-gray-50 dark:focus:bg-gray-700 transition-colors",type:"button"},[r("div",{class:c(["w-3 h-3 rounded-full flex-shrink-0",o.type==="income"?"bg-teal-500":"bg-coral-500"])},null,2),r("span",Ye,g(o.name),1)],8,Qe))),128))])])):V("",!0)]),r("div",Ge,[r("input",{onInput:H,type:"text",placeholder:" ",value:_.value,class:c(["peer w-full px-4 py-3 border rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-transparent transition-colors duration-200",R.value?"border-red-500 dark:border-red-400 focus:ring-2 focus:ring-red-500":"border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-teal-500 focus:border-transparent"]),required:""},null,42,Re),r("label",Xe,[l(s(xe),{class:"w-3 h-3 inline mr-1"}),e[11]||(e[11]=m(" Jumlah ",-1))])]),r("div",Ze,[r("div",et,[v(r("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s(a).date=o),type:"date",placeholder:" ",class:c(["peer w-full px-4 py-3 border rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-transparent transition-colors duration-200",X.value?"border-red-500 dark:border-red-400 focus:ring-2 focus:ring-red-500":"border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-teal-500 focus:border-transparent"]),required:""},null,2),[[k,s(a).date]]),r("label",tt,[l(s(we),{class:"w-3 h-3 inline mr-1"}),e[12]||(e[12]=m(" Tanggal ",-1))])]),r("div",rt,[v(r("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s(a).time=o),type:"time",placeholder:" ",class:"peer w-full px-4 py-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent placeholder-transparent",required:""},null,512),[[k,s(a).time]]),r("label",at,[l(s(ve),{class:"w-3 h-3 inline mr-1"}),e[13]||(e[13]=m(" Waktu ",-1))])])]),r("div",ot,[v(r("textarea",{"onUpdate:modelValue":e[8]||(e[8]=o=>s(a).note=o),placeholder:" ",rows:"2",class:"peer w-full px-4 py-3 border border-gray-200 dark:border-gray-700 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent resize-none placeholder-transparent"},null,512),[[k,s(a).note]]),r("label",st,[l(s(ke),{class:"w-3 h-3 inline mr-1"}),e[14]||(e[14]=m(" Catatan (Opsional) ",-1))])]),r("div",nt,[r("label",lt,[l(s(_e),{class:"w-4 h-4 inline mr-2"}),e[15]||(e[15]=m(" Tag (Opsional) ",-1))]),r("div",it,[(d(!0),p(S,null,A(t.masterData.tags,o=>(d(),p("button",{type:"button",key:o.id,onClick:u=>te(o.id),class:c([s(a).tag_ids.includes(o.id)?"bg-teal-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300","px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200"])},g(o.name),11,dt))),128))])]),r("button",{type:"submit",disabled:s(a).processing,class:"w-full bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 text-white font-semibold py-4 rounded-xl transition-all duration-200 flex items-center justify-center gap-2 shadow-lg disabled:opacity-50"},[l(s(Ce),{class:"w-5 h-5"}),m(" "+g(s(a).processing?"Menyimpan...":"Perbarui Transaksi"),1)],8,ct)],32)])]),_:1}))}});export{Ut as default};
