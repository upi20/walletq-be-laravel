import{d as J,m as K,z as h,c as _,P as U,H as W,h as x,o as r,w as D,f as c,e as s,b,u as l,j as X,t as d,g as L,a as u,F as I,r as j,l as Y,k as Z,B as A}from"./app-CpxPSk2w.js";import{F as tt}from"./FinancialAppLayout-D9Y2dRaH.js";import{u as et}from"./useTranslation-DPvSmIIm.js";import{f as O}from"./formatCurrency-6zMsDc4Z.js";import at from"./SearchModal-DHCQwRFK.js";import st from"./FilterModal-C2arGh1f.js";import ot from"./TransactionCard-CGrQnqm1.js";import{S as nt}from"./search-DQ9PXY1z.js";import{F as rt}from"./filter-DBc-tKm4.js";import{C as it}from"./chevron-left-BoHFBZS6.js";import{C as B}from"./calendar-jM8SHZ85.js";import{C as lt}from"./chevron-right-Cqmcaz5y.js";import{D as ct}from"./dollar-sign-Hmyj7hj7.js";import"./useDarkMode-CPfEmPz6.js";import"./createLucideIcon-CxMOwcMx.js";import"./x-sqW9_gms.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./trending-up-Bf7i0duD.js";import"./settings-Cz58leFT.js";import"./sun-DhMHM8Is.js";import"./rotate-ccw-CbX8c0bl.js";import"./credit-card-DvKJLfBl.js";import"./folder-open-DVNWR4VP.js";import"./tag-BA6I5CpT.js";import"./trending-down-7rElmRRF.js";import"./receipt-CqvJQWyV.js";import"./arrow-right-left-CVzE9XSL.js";import"./trash-2-ChkN5Du9.js";import"./eye-BhHy6kpU.js";import"./square-pen-DsBtEEyT.js";const dt={class:"bg-gradient-to-r from-teal-500 to-teal-600 dark:from-teal-600 dark:to-teal-700 rounded-b-[24px] px-4 pt-4 pb-6 mb-4 shadow-lg dark:shadow-2xl"},ut={class:"flex items-center justify-between mb-4"},mt={class:"flex-1 min-w-0"},ht={class:"text-xl font-semibold text-white truncate"},pt={class:"text-sm text-teal-100 dark:text-teal-200 truncate"},ft={class:"flex items-center gap-2 ml-3"},gt={key:0,class:"absolute -top-1 -right-1 w-3 h-3 bg-white rounded-full"},vt={class:"flex items-center justify-between mb-4 bg-white/10 rounded-xl p-3"},_t={class:"flex items-center gap-2 text-white"},xt={class:"font-medium"},bt={class:"px-4"},yt={key:0,class:"space-y-4"},wt={class:"bg-gray-50 dark:bg-gray-700/50 px-4 py-3 border-b border-gray-200 dark:border-gray-700"},kt={class:"flex items-center justify-between"},Ct={class:"flex items-center gap-2"},Mt={class:"text-sm font-medium text-gray-900 dark:text-white"},St={class:"text-right"},Ft={class:"divide-y divide-gray-100 dark:divide-gray-700"},Tt={key:1,class:"text-center py-12 px-4"},Dt={class:"text-gray-400 mb-6"},Lt={class:"text-sm text-gray-500 mt-1"},It={class:"flex flex-col gap-3"},de=J({__name:"IndexBackup",props:{transactions:{},pageTitle:{}},setup(N){const k=N;et();const{success:jt,error:At,warning:E,info:C}=K();h(!1);const y=h(!1),w=h(!1),p=h(new Date().toISOString().slice(0,7)),m=h(""),e=h({account_ids:[],category_ids:[],type:"both",flags:[],tag_ids:[],amount_min:void 0,amount_max:void 0}),g=_(()=>new Date(p.value+"-01").toLocaleDateString("id-ID",{month:"long",year:"numeric"})),v=_(()=>!!(m.value||e.value.account_ids.length>0||e.value.category_ids.length>0||e.value.tag_ids.length>0||e.value.type!=="both"||e.value.flags.length>0||e.value.amount_min||e.value.amount_max));_(()=>{const a=k.transactions.data.filter(o=>new Date(o.date).toISOString().slice(0,7)===p.value),n=a.filter(o=>o.type==="income").reduce((o,i)=>o+i.amount,0),t=a.filter(o=>o.type==="expense").reduce((o,i)=>o+i.amount,0);return{total_income:n,total_expense:t,net_amount:n-t,transaction_count:a.length,period_label:g.value}});const M=_(()=>{let a=k.transactions.data.filter(t=>{if(new Date(t.date).toISOString().slice(0,7)!==p.value)return!1;if(m.value){const i=m.value.toLowerCase(),T=t.note?.toLowerCase().includes(i),f=t.account?.name?.toLowerCase().includes(i),$=t.category?.name?.toLowerCase().includes(i);if(!T&&!f&&!$)return!1}if(e.value.type!=="both"&&t.type!==e.value.type||e.value.account_ids.length>0&&!e.value.account_ids.includes(t.account_id)||e.value.category_ids.length>0&&!e.value.category_ids.includes(t.transaction_category_id)||e.value.flags.length>0&&!e.value.flags.includes(t.flag))return!1;if(e.value.tag_ids.length>0){const i=t.tags?.map(f=>f.id)||[];if(!e.value.tag_ids.some(f=>i.includes(f)))return!1}return!(e.value.amount_min&&t.amount<e.value.amount_min||e.value.amount_max&&t.amount>e.value.amount_max)});const n={};return a.forEach(t=>{const o=new Date(t.date).toISOString().slice(0,10);n[o]||(n[o]={date:o,dateLabel:new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),transactions:[],subtotal:{income:0,expense:0,net:0}}),n[o].transactions.push(t),t.type==="income"?n[o].subtotal.income+=t.amount:n[o].subtotal.expense+=t.amount}),Object.values(n).forEach(t=>{t.subtotal.net=t.subtotal.income-t.subtotal.expense,t.subtotalFormatted=O(Math.abs(t.subtotal.net))+(t.subtotal.net>=0,""),t.subtotalPrefix=t.subtotal.net>=0?"+":"-"}),Object.values(n).sort((t,o)=>o.date.localeCompare(t.date))}),V=()=>{y.value=!0},S=()=>{y.value=!1},H=()=>{w.value=!0},F=()=>{w.value=!1},P=()=>{const a=new Date(p.value+"-01");a.setMonth(a.getMonth()-1);const n=a.toISOString().slice(0,7);A.get("/transactions",{month:n},{preserveState:!0,preserveScroll:!0})},q=()=>{const a=new Date(p.value+"-01");a.setMonth(a.getMonth()+1);const n=a.toISOString().slice(0,7);A.get("/transactions",{month:n},{preserveState:!0,preserveScroll:!0})},z=a=>{m.value=a,S()},R=a=>{e.value={...a},F()},G=()=>{m.value="",e.value={account_ids:[],category_ids:[],type:"both",flags:[],tag_ids:[],amount_min:void 0,amount_max:void 0}},Q=(a,n)=>{switch(a){case"view":C("Fitur lihat detail akan segera hadir");break;case"edit":C("Fitur edit transaksi akan segera hadir");break;case"delete":E("Fitur hapus transaksi akan segera hadir");break}};return U(()=>e.value,a=>{},{deep:!0}),W(()=>{}),(a,n)=>(r(),x(tt,{showHeader:!1,showFab:!1,containerClass:"px-0"},{default:D(()=>[c(l(X),{title:a.pageTitle},null,8,["title"]),s("div",dt,[s("div",ut,[s("div",mt,[s("h1",ht,d(a.pageTitle),1),s("p",pt,d(g.value),1)]),s("div",ft,[s("button",{onClick:V,class:"p-3 bg-white/20 hover:bg-white/30 rounded-xl text-white transition-colors duration-200 min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Cari"},[c(l(nt),{class:"w-5 h-5"})]),s("button",{onClick:H,class:L([v.value?"bg-white/30 ring-2 ring-white/50":"bg-white/20 hover:bg-white/30","p-3 rounded-xl text-white transition-colors duration-200 min-w-[44px] min-h-[44px] flex items-center justify-center relative"]),title:"Filter"},[c(l(rt),{class:"w-5 h-5"}),v.value?(r(),u("div",gt)):b("",!0)],2)])]),s("div",vt,[s("button",{onClick:P,class:"p-2 hover:bg-white/20 rounded-lg text-white transition-colors duration-200 min-w-[44px] min-h-[44px] flex items-center justify-center"},[c(l(it),{class:"w-5 h-5"})]),s("div",_t,[c(l(B),{class:"w-4 h-4"}),s("span",xt,d(g.value),1)]),s("button",{onClick:q,class:"p-2 hover:bg-white/20 rounded-lg text-white transition-colors duration-200 min-w-[44px] min-h-[44px] flex items-center justify-center"},[c(l(lt),{class:"w-5 h-5"})])])]),s("div",bt,[M.value.length>0?(r(),u("div",yt,[(r(!0),u(I,null,j(M.value,t=>(r(),u("div",{key:t.date,class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden"},[s("div",wt,[s("div",kt,[s("div",Ct,[c(l(B),{class:"w-4 h-4 text-gray-500 dark:text-gray-400"}),s("span",Mt,d(t.dateLabel),1)]),s("div",St,[s("span",{class:L(["text-sm font-semibold",t.subtotal.net>=0?"text-teal-600 dark:text-teal-400":"text-coral-600 dark:text-coral-400"])},d(t.subtotalPrefix)+"Rp "+d(l(O)(Math.abs(t.subtotal.net),"decimal")),3)])])]),s("div",Ft,[(r(!0),u(I,null,j(t.transactions,o=>(r(),x(ot,{key:o.id,transaction:o,onAction:Q},null,8,["transaction"]))),128))])]))),128))])):(r(),u("div",Tt,[s("div",Dt,[c(l(ct),{class:"w-16 h-16 mx-auto mb-4 opacity-50"}),n[0]||(n[0]=s("p",{class:"text-lg font-medium"},"Tidak ada transaksi",-1)),s("p",Lt,d(v.value?"Tidak ada transaksi yang sesuai dengan filter yang dipilih":`Belum ada transaksi di ${g.value}`),1)]),s("div",It,[v.value?(r(),u("button",{key:0,onClick:G,class:"w-full py-3 text-teal-600 border border-teal-600 rounded-xl hover:bg-teal-50 dark:hover:bg-teal-900/20 transition-colors duration-200 font-medium"}," Hapus Filter ")):b("",!0),c(l(Y),{href:"/transactions/create",class:"w-full py-3 bg-teal-500 text-white rounded-xl hover:bg-teal-600 transition-colors duration-200 font-medium text-center"},{default:D(()=>n[1]||(n[1]=[Z(" Tambah Transaksi ",-1)])),_:1,__:[1]})])]))]),y.value?(r(),x(at,{key:0,"initial-query":m.value,onApply:z,onClose:S},null,8,["initial-query"])):b("",!0),w.value?(r(),x(st,{key:1,filters:e.value,"master-data":a.transactions.master_data,onApply:R,onClose:F},null,8,["filters","master-data"])):b("",!0)]),_:1}))}});export{de as default};
